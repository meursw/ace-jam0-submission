[gd_scene load_steps=23 format=3 uid="uid://dp4bbu73qs6sc"]

[ext_resource type="Script" path="res://Scripts/level_3_darkness.gd" id="1_26yqo"]
[ext_resource type="Shader" path="res://Shaders/ps1_postprocess.gdshader" id="2_5iifb"]
[ext_resource type="Resource" uid="uid://q8lswj50flya" path="res://Resources/DialogueResources/darkness.tres" id="2_k5nqq"]
[ext_resource type="PackedScene" uid="uid://cs7m78tstb6od" path="res://Scenes/UI/ui.tscn" id="3_2wr5b"]
[ext_resource type="Resource" uid="uid://bfosheu0h5k6b" path="res://Resources/DialogueResources/level_complete_dialogue.tres" id="3_vmbat"]
[ext_resource type="PackedScene" uid="uid://g84m6pdvsd65" path="res://Scenes/Enemies/ghost.tscn" id="4_4w4a4"]
[ext_resource type="PackedScene" uid="uid://cttqgfopdwiv" path="res://Scenes/player.tscn" id="5_gsc0t"]
[ext_resource type="Material" uid="uid://cq2u18re4t0ba" path="res://Assets/Misc/dark_room.tres" id="6_j36ol"]
[ext_resource type="Script" path="res://Components/gameover_component.gd" id="6_uhbuu"]
[ext_resource type="Script" path="res://Scripts/teleport_component.gd" id="6_uise6"]
[ext_resource type="PackedScene" uid="uid://brnujn0unn3t" path="res://Levels/ending.tscn" id="7_80dlg"]
[ext_resource type="Texture2D" uid="uid://bv60nv6dgc4d8" path="res://addons/kenney_prototype_textures/dark/texture_01.png" id="7_82s4l"]
[ext_resource type="PackedScene" uid="uid://duf8ffj4e2ulr" path="res://Scenes/game_over_scene.tscn" id="7_iqsjs"]
[ext_resource type="PackedScene" uid="uid://cfgilkh2r3kxv" path="res://Scenes/pickup.tscn" id="8_olmjm"]
[ext_resource type="Resource" uid="uid://dd4685t15f3es" path="res://Resources/WeaponResources/ghost_trap.tres" id="9_h6fp4"]
[ext_resource type="PackedScene" uid="uid://pxurkal5ey0q" path="res://Assets/Blender/Enviroment/pedestal.blend" id="10_e0ra5"]

[sub_resource type="Environment" id="Environment_hlhuo"]
tonemap_mode = 3
sdfgi_enabled = true
glow_normalized = true
glow_blend_mode = 0
volumetric_fog_enabled = true
volumetric_fog_density = 0.1575
volumetric_fog_albedo = Color(0.596078, 0.462745, 0.976471, 1)
volumetric_fog_detail_spread = 3.4822
volumetric_fog_sky_affect = 0.679

[sub_resource type="ShaderMaterial" id="ShaderMaterial_s81vj"]
shader = ExtResource("2_5iifb")
shader_parameter/change_color_depth = true
shader_parameter/target_color_depth = 3
shader_parameter/dithering = true
shader_parameter/scale_resolution = true
shader_parameter/target_resolution_scale = 2
shader_parameter/enable_recolor = false

[sub_resource type="NavigationMesh" id="NavigationMesh_317l2"]
vertices = PackedVector3Array(-8.39819, 0.5, -13.791, -4.64819, 0.5, -13.791, -4.64819, 0.5, -26.291, -8.39819, 0.5, -26.291, -11.8982, 0.5, -3.04097, -14.1482, 0.5, -2.79097, -14.1482, 0.5, 0.70903, -11.8982, 0.5, 0.95903, -4.39819, 0.5, -11.791, -8.64819, 0.5, -11.791, -11.8982, 0.5, -3.04097, -11.8982, 0.5, 0.95903, -4.39819, 0.5, -11.791, -4.64819, 0.5, -13.791, -8.39819, 0.5, -13.791, -8.64819, 0.5, -11.791, -11.8982, 0.5, 11.959, -1.89819, 0.5, 12.209, 1.35181, 0.5, 12.209, 1.35181, 0.5, 12.209, 1.35181, 0.5, 19.959, 5.10181, 0.5, 19.959, 5.10181, 0.5, 12.209, -11.8982, 0.5, 0.95903, -11.8982, 0.5, 11.959, 1.35181, 0.5, 12.209, 11.8518, 0.5, 11.959, 11.8518, 0.5, -11.791, -4.39819, 0.5, -11.791, -8.64819, 0.5, -11.791, -11.8982, 0.5, -11.791, -11.8982, 0.5, -3.04097, -11.8982, 0.5, 11.959, -5.64819, 0.5, 12.209, -1.89819, 0.5, 12.209, 1.35181, 0.5, 12.209, 5.10181, 0.5, 12.209, 11.8518, 0.5, 11.959, -14.1482, 0.5, 0.70903, -14.1482, 0.5, -2.79097, -27.1482, 0.5, -2.79097, -27.1482, 0.5, 0.70903, -5.64819, 0.5, 17.459, -7.89819, 0.5, 17.709, -7.89819, 0.5, 21.209, -3.14819, 0.5, 21.209, -3.14819, 0.5, 20.209, -1.89819, 0.5, 19.959, -1.89819, 0.5, 12.209, -5.64819, 0.5, 12.209, -5.64819, 0.5, 17.459, -3.14819, 0.5, 20.209, -7.89819, 0.5, 21.209, -7.89819, 0.5, 17.709, -17.1482, 0.5, 17.709, -17.1482, 0.5, 21.209)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1), PackedInt32Array(5, 4, 6), PackedInt32Array(6, 4, 7), PackedInt32Array(9, 8, 10), PackedInt32Array(10, 8, 11), PackedInt32Array(13, 12, 14), PackedInt32Array(14, 12, 15), PackedInt32Array(18, 17, 16), PackedInt32Array(22, 21, 19), PackedInt32Array(19, 21, 20), PackedInt32Array(24, 23, 25), PackedInt32Array(25, 23, 26), PackedInt32Array(26, 23, 28), PackedInt32Array(26, 28, 27), PackedInt32Array(31, 30, 29), PackedInt32Array(34, 33, 32), PackedInt32Array(37, 36, 35), PackedInt32Array(41, 40, 38), PackedInt32Array(38, 40, 39), PackedInt32Array(46, 45, 42), PackedInt32Array(42, 45, 43), PackedInt32Array(43, 45, 44), PackedInt32Array(51, 50, 47), PackedInt32Array(47, 50, 49), PackedInt32Array(47, 49, 48), PackedInt32Array(55, 54, 52), PackedInt32Array(52, 54, 53)]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_wxfu8"]
albedo_color = Color(0.054902, 0.054902, 0.054902, 1)
albedo_texture = ExtResource("7_82s4l")
uv1_triplanar = true

[sub_resource type="BoxShape3D" id="BoxShape3D_h256n"]
size = Vector3(5, 5, 5)

[sub_resource type="SphereShape3D" id="SphereShape3D_vhx1d"]

[node name="Level_3_Darkness" type="Node3D"]
script = ExtResource("1_26yqo")
dialogue_intro = ExtResource("2_k5nqq")
dialogue_end = ExtResource("3_vmbat")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_hlhuo")

[node name="UI-HUD" type="Node" parent="."]

[node name="ColorRect" type="ColorRect" parent="UI-HUD"]
top_level = true
light_mask = 0
material = SubResource("ShaderMaterial_s81vj")
offset_right = 800.0
offset_bottom = 603.0

[node name="UI" parent="UI-HUD" instance=ExtResource("3_2wr5b")]

[node name="DialogueUI" parent="UI-HUD/UI" index="0"]
offset_left = 171.0
offset_top = -437.0
offset_right = 171.0
offset_bottom = -437.0

[node name="Label" parent="UI-HUD/UI/DialogueUI/DialogueBG" index="0"]
offset_left = -43.0
offset_top = 412.0
offset_right = 85.0
offset_bottom = 412.0

[node name="InventoryUI" parent="UI-HUD/UI" index="1"]
offset_left = 564.0
offset_top = 517.0
offset_right = 156.0
offset_bottom = -83.0
scale = Vector2(0.6, 0.6)

[node name="GameOverComponent" type="Node" parent="."]
script = ExtResource("6_uhbuu")
game_over_scene = ExtResource("7_iqsjs")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_317l2")

[node name="CSGBox3D" type="CSGBox3D" parent="NavigationRegion3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)
material_override = ExtResource("6_j36ol")
operation = 2
use_collision = true
flip_faces = true
size = Vector3(25, 4, 25)

[node name="CSGBox3D2" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -16.6982, 0, -1.07117)
material_override = ExtResource("6_j36ol")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D6" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -23.6982, 0, -1.07117)
material_override = ExtResource("6_j36ol")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D7" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 3.30181, 0, 16.3288)
material_override = ExtResource("6_j36ol")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D8" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -3.69819, 0, 16.3288)
material_override = SubResource("StandardMaterial3D_wxfu8")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D9" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.69819, 0, 19.4924)
material_override = ExtResource("6_j36ol")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D10" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -13.6982, 0, 19.4924)
material_override = ExtResource("6_j36ol")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D12" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -6.49819, 0, -14.841)
material_override = SubResource("StandardMaterial3D_wxfu8")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGBox3D13" type="CSGBox3D" parent="NavigationRegion3D/CSGBox3D"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -6.49819, 0, -22.841)
material_override = SubResource("StandardMaterial3D_wxfu8")
use_collision = true
flip_faces = true
size = Vector3(8.4, 4, 4.927)

[node name="CSGCylinder3D" type="CSGCylinder3D" parent="NavigationRegion3D/CSGBox3D"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.080256, -4.83108, 0)
visible = false
flip_faces = true
radius = 1.808
height = 11.275

[node name="SpotLight3D" type="SpotLight3D" parent="NavigationRegion3D/CSGBox3D/CSGCylinder3D"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 5.31136, 0)
light_color = Color(0.847059, 0.0980392, 0.215686, 1)
light_energy = 56.22
spot_range = 5.433
spot_attenuation = 0.0915055
spot_angle_attenuation = 0.0743254

[node name="TeleportComponent" type="Area3D" parent="NavigationRegion3D/CSGBox3D/CSGCylinder3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 3.03446, 0)
script = ExtResource("6_uise6")
next_level = ExtResource("7_80dlg")

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/CSGBox3D/CSGCylinder3D/TeleportComponent"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -6.29543, 0)
shape = SubResource("BoxShape3D_h256n")

[node name="OmniLight3D" type="OmniLight3D" parent="NavigationRegion3D/CSGBox3D/CSGCylinder3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -5.19671, 0)
light_energy = 16.0
light_negative = true
omni_range = 5.731

[node name="Player" parent="." instance=ExtResource("5_gsc0t")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, 0, -0.157237)

[node name="Enemies" type="Node3D" parent="."]
unique_name_in_owner = true

[node name="Ghost" parent="Enemies" instance=ExtResource("4_4w4a4")]
transform = Transform3D(5.96046e-08, 0, 1, 0, 1, 0, -1, 0, 5.96046e-08, -25, -0.4, -1)

[node name="Ghost2" parent="Enemies" instance=ExtResource("4_4w4a4")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 3.4, -0.4, 17.6)
_aggro_range = 10.0

[node name="Ghost3" parent="Enemies" instance=ExtResource("4_4w4a4")]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, -15, -0.4, 19)

[node name="Ghost4" parent="Enemies" instance=ExtResource("4_4w4a4")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6.5, -0.4, -24.9)

[node name="Pickup3" parent="." instance=ExtResource("8_olmjm")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.320038, 1.6652, 3.60526)
item = ExtResource("9_h6fp4")

[node name="CollisionShape3D" parent="Pickup3" index="0"]
shape = SubResource("SphereShape3D_vhx1d")

[node name="pedestal" parent="Pickup3" instance=ExtResource("10_e0ra5")]
transform = Transform3D(2, 0, 0, 0, 2, 0, 0, 0, 2, 0, -1.71201, 0)

[node name="SpotLight3D" type="SpotLight3D" parent="Pickup3"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 2, 0)
light_color = Color(0.501961, 0.352941, 0.94902, 1)
light_energy = 6.622
spot_attenuation = 0.450625
spot_angle = 10.3684

[node name="Lights" type="Node3D" parent="."]

[node name="OmniLight3D" type="OmniLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7.74794, 3.2, 8.8178)
light_color = Color(0.392157, 0.972549, 0.807843, 1)
light_energy = 3.0
omni_range = 8.0
omni_attenuation = 0.307786

[node name="OmniLight3D2" type="OmniLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.25206, 3.2, 8.8178)
light_color = Color(0.392157, 0.972549, 0.807843, 1)
light_energy = 3.0
omni_range = 8.0
omni_attenuation = 0.307786

[node name="OmniLight3D3" type="OmniLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.25206, 3.2, -8.1822)
light_color = Color(0.392157, 0.972549, 0.807843, 1)
light_energy = 3.0
omni_range = 8.0
omni_attenuation = 0.307786

[node name="OmniLight3D4" type="OmniLight3D" parent="Lights"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.74794, 3.2, -8.1822)
light_color = Color(0.392157, 0.972549, 0.807843, 1)
light_energy = 3.0
omni_range = 8.0
omni_attenuation = 0.307786

[connection signal="body_entered" from="NavigationRegion3D/CSGBox3D/CSGCylinder3D/TeleportComponent" to="." method="_on_teleport_component_body_entered"]
[connection signal="body_entered" from="NavigationRegion3D/CSGBox3D/CSGCylinder3D/TeleportComponent" to="NavigationRegion3D/CSGBox3D/CSGCylinder3D/TeleportComponent" method="_on_body_entered"]

[editable path="UI-HUD/UI"]
[editable path="Pickup3"]
